<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Valentine's</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
  <style>
    .code-signature {
      position: fixed;
      bottom: 20px;
      right: 20px;
      font-family: 'Arial', sans-serif;
      color: rgba(255, 105, 180, 0.7); 
      font-size: 1em;
      text-shadow: 0 0 10px rgba(255, 105, 180, 0.3);
      letter-spacing: 2px;
      font-weight: bold;
      opacity: 0.8;
      transition: opacity 0.3s ease;
    }

    .code-signature:hover {
      opacity: 1;
      text-shadow: 0 0 15px rgba(255, 105, 180, 0.5);
    }
  </style>
</head>

<body>
  <div class="start-screen">
    <div class="title-container">
      <div class="title-wrapper">
        <h1 class="main-title">Happy Birthday</h1>
        <div class="title-overlay"></div>
      </div>
      <h2 class="sub-title"></h2>
      <button class="start-button" onclick="launchExperience()">
        <span class="button-text">❤ Bước vào vũ trụ ❤</span>
        <div class="button-shine"></div>
      </button>
      <div class="floating-hearts">
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
        <div class="heart">♥</div>
      </div>
    </div>
    <div class="code-signature">CODE by HL</div>
  </div>

  <div class="scene">
    <div class="valentine-text">
      <div class="main-text">Happy Birthday</div>
    </div>
    <button class="scene-start-button" onclick="transitionToNewScene()">
      <span class="button-text">❤ Lời chúc sinh nhật ❤</span>
      <div class="button-shine"></div>
      <div class="button-glow"></div>
    </button>
  </div>

  <!-- Thêm trang mới -->
  <div class="new-scene">
    <div class="letter-container">
        <div class="letter-content">
            <p class="line typed-line letter-title">Lời chúc sinh nhật</p>
            <p class="line typed-line">&nbsp;</p>
            <p class="line typed-line">Gửi Khánh Vi,</p>
            <p class="line typed-line">&nbsp;</p>
            <p class="line typed-line">Nhân dịp sinh nhật, tui chúc bà sẽ mãi hạnh phúc bên gia đình và người thân. Tuổi</p>
            <p class="line typed-line">mới xinh đẹp hơn và suy nghĩ thông suốt hơn, không phải đau đầu nữa.</p>
            <p class="line typed-line">Mong mọi điều tốt đẹp nhất sẽ đến với bà, những điều bà muốn làm sẽ làm được.</p>
            <p class="line typed-line">Tui hi vọng bà sẽ mãi vui cười và ít khóc ( nếu khóc thì chỉ khóc vì hạnh phúc ).</p>
            <p class="line typed-line">&nbsp;</p>
            <p class="line typed-line">Mong bà sẽ bỏ lại bớt những suy nghĩ tiêu cực và hãy luôn tin vào những quyết</p>
            <p class="line typed-line">định của bản thân.</p>
            <p class="line typed-line">Rất vui vì được làm quen với bà. Lúc nào tui cũng vấn ở đây, bất cứ lúc nào bà</p>
            <p class="line typed-line">cần tui sẽ có mặt. Mong bà thứ lỗi vì lâu lâu tui nói chuyện hơi khờ.</p>
            <p class="line typed-line">&nbsp;</p>
            <p class="line typed-line">Món quà này có vẻ hơi sơ sài, nhưng tui hi vọng bà sẽ thích nó.</p>
            <p class="line typed-line">&nbsp;</p>
            <p class="line typed-line">Keep your health and wish all the best for you ! ♥️</p>
        </div>
    </div>
  </div>

  <div class="loading-screen">Đang khởi tạo vũ trụ...</div>
  <script type="module" src="diamond-heart.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const button = document.querySelector('.start-button');
      const mainTitle = document.querySelector('.main-title');
      
      setTimeout(() => {
        new Typed('.sub-title', {
          strings: ['Nguyễn Ngọc Khánh Vi ❤'],
          typeSpeed: 50,
          backSpeed: 30,
          backDelay: 3000,
          loop: false,
          showCursor: false,
          cursorChar: '❤',
          autoInsertCss: true,
          startDelay: 500,
          onComplete: function() {
            button.style.transition = 'all 2.5s cubic-bezier(0.4, 0, 0.2, 1)';
            button.style.opacity = '1';
            button.style.transform = 'translateY(0) scale(1)';
          }
        });
      }, 1500);

      // Add typed effect for letter content
      const newScene = document.querySelector('.new-scene');
      const typedLines = document.querySelectorAll('.typed-line');
      
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.target.classList.contains('visible')) {
            // Đợi transition hoàn thành (8 giây theo transition của .new-scene)
            setTimeout(() => {
              // Start typing effect for the first line, then chain the rest
              startTypingSequence(typedLines);
            }, 5500); // Đợi 8 giây cho transition hoàn thành
            observer.disconnect();
          }
        });
      });

      function startTypingSequence(lines, index = 0) {
        if (index >= lines.length) return;
        
        const line = lines[index];
        const currentContent = line.textContent;
        line.textContent = '';
        
        // Skip empty lines or lines with only &nbsp;
        if (currentContent.trim() === '' || currentContent === '\u00A0') {
          line.style.opacity = '1';
          // Move to next line immediately
          startTypingSequence(lines, index + 1);
          return;
        }
        
        // Make current line visible
        line.style.opacity = '1';
        
        new Typed(line, {
          strings: [currentContent],
          typeSpeed: 30, // Faster typing speed
          startDelay: 0,
          showCursor: false,
          onComplete: function(self) {
            // When this line is complete, start the next one
            startTypingSequence(lines, index + 1);
          }
        });
      }

      observer.observe(newScene, {
        attributes: true,
        attributeFilter: ['class']
      });
    });
  </script>
</body>
</html>